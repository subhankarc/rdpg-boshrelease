#!/var/vcap/packages/bash-4.3/bin/bash

source "$(dirname $(dirname ${0}))/shell/env"

action=$1
shift || fail "$0 {ha_pb_pg}"

case ${action} in
  (ha_pb_pg) 
    psql -U postgres -h 127.0.0.1 -p ${haproxyWritePort} ${rdpgDB} -t \
      -c 'SELECT CURRENT_TIMESTAMP;'
    ;;
  (pb)
    psql -U postgres -h 127.0.0.1 -p ${pgbListenPort} ${rdpgDB} -t \
      -c 'SELECT CURRENT_TIMESTAMP;'
    ;;
  (pg)
    psql -U postgres -h 127.0.0.1 -p ${pgbdrPort} ${rdpgDB} -t \
      -c 'SELECT CURRENT_TIMESTAMP;'
    ;;
  (*)
    fail "Unknown check action ${action}"
    ;;
esac
